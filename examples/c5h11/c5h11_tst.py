#! /usr/bin/env python3

"""
TST calculations for:
nC5H11 <=> C2H4 + nC3H7
sC5H11 <=> C3H6 + C2H5
"""

from me2d import RoVib
from me2d import tstrates, equilibrium_consts_12, name2weight


nc5h11 = RoVib(\
    nsym = 1,
    rotA = 0.609391,
    rotB2D = 0.0654364,
    freq = [113.598, 120.817, 184.873, 247.846, 401.834, 410.665, 469.376, 731.748,
            780.563, 872.445, 922.568, 947.387, 1043.24, 1079.07, 1098.31, 1105.21,
            1168.56, 1235.09, 1289.54, 1312.72, 1337.06, 1371.45, 1416.27, 1420.43,
            1466.27, 1468.73, 1493.98, 1500.6, 1503.72, 1512.2, 2952.34, 3021.08,
            3024.77, 3032.49, 3036.95, 3054.91, 3077.94, 3109.68, 3116.83, 3146.86,
            3253.57],
    fscale = 0.95,
    introt = [(10.1083, 2, 0, 0)],  # free rotor
    states = [(1, 0), (2, 9.01), (2, 89.1), (2, 143.23), (2, 361.86)] # conformers
    )

sc5h11 = RoVib(\
    nsym = 1,
    rotA = 0.64564,
    rotB2D = 0.0633999,
    freq = [117.076, 181.245, 241.578, 338.637, 405.582, 409.762, 740.463, 862.016,
            887.444, 947.624, 982.493, 1052.52, 1079.03, 1093.84, 1146.64, 1180.52,
            1253.02, 1286.53, 1326.41, 1370.7, 1409.52, 1420.08, 1435.14, 1470.15,
            1477.71, 1488.83, 1498.07, 1502.87, 1510.26, 2940.31, 2972.28, 2998.95,
            3036.22, 3038.24, 3041.47, 3074.74, 3109.06, 3115.43, 3117.51, 3173.02],
    fscale = 0.95,
    introt = [(1.56492, 3, 0, 0),  # free rotor
              (5.94229, 3, 0, 0)],  # free rotor
    states = [(1, 0), (2, 1.99), (2, 5.86), (2, 38.73), (2, 658.54)] # conformers
    )

c2h4 = RoVib(\
    nsym = 4,
    rotA = 4.89739,
    rotB2D = 0.92091,
    freq = [841.004, 984.941, 996.382, 1066.71, 1242.3, 1386.92, 1471.45, 1708.75,
            3138.51, 3158.1, 3220.16, 3246.5],
    fscale = 0.95,
    states = [(1, 0)]
    )

nc3h7 = RoVib(\
    nsym = 1,
    rotA = 1.10189,
    rotB2D = 0.279377,
    freq = [250.196, 379.029, 467.993, 762.122, 890.026, 932.685, 1052.69, 1100.62,
            1174.23, 1272.97, 1366.72, 1418.08, 1466.2, 1471.32, 1502.51, 1508.29,
            2965.42, 3031.31, 3041.89, 3115.12, 3122.37, 3146.24, 3253.11],
    fscale = 0.95,
    introt = [(10.5666, 2, 0, 0)],  # free rotor
    states = [(1, 0)]
    )
 
c2h5 = RoVib(\
    nsym = 1,
    rotA = 3.45554,
    rotB2D = 0.732352,
    freq = [109.141, 478.76, 817.705, 979.661, 1077.29, 1193.25, 1401.45, 1467.41,
            1485.28, 1487.74, 2979.47, 3066.05, 3113.43, 3154.77, 3260.22],
    fscale = 0.95,
    introt = [(15.0550, 6, 0, 0)],  # free rotor
    states = [(1, 0)]
    )

c3h6 = RoVib(\
    nsym = 1,
    rotA = 1.56516,
    rotB2D = 0.291208,
    freq = [198.439, 434.301, 594.79, 935.31, 952.92, 956.274, 1033.04, 1077.5,
            1197.14, 1333.27, 1410.44, 1453.51, 1484.3, 1498.36, 1735.37, 3036.59,
            3098.05, 3122.49, 3140.24, 3153.61, 3233.12],
    fscale = 0.95,
    states = [(1, 0)]
    )
    
ts_ncc = RoVib(\
    nsym = 1,
    rotA = 0.229743,
    rotB2D = 0.0854228,
    freq = [119.12, 166.293, 250.424, 295.145, 361.419, 413.49, 571.327, 745.144,
            808.473, 826.663, 861.237, 892.759, 930.289, 954.743, 1018.81, 1083.88,
            1103.39, 1190.6, 1238.7, 1286.39, 1305.51, 1372.36, 1418.59, 1463.33,
            1465.82, 1477.05, 1504.31, 1508.79, 1586.45, 2992.47, 3040.75, 3052.41,
            3112.97, 3115.87, 3121.05, 3141.69, 3153.36, 3213.03, 3223.87, 3248.19],
    fscale = 0.95,
    introt = [(1.05143, 3, 0, 0)],  # free rotor
    states = [(2, 0), (2, 235.81), (2, 247.77), (1, 328.21), (2, 390.09)], # conformers
    freqimg = 474.82
    )


ts_scc = RoVib(\
    nsym = 1,
    rotA = 0.259238,
    rotB2D = 0.0758349,
    freq = [107.052, 136.519, 175.27, 190.914, 316.005, 432.051, 545.709, 663.579,
            771.005, 835.18, 892.786, 928.455, 939.933, 995.211, 1036, 1048.61,
            1081.85, 1194.39, 1217.57, 1294.18, 1402.86, 1404.58, 1439.14, 1473.22,
            1481.02, 1488.19, 1490.39, 1495.77, 1600.04, 3008.6, 3018.98, 3073.54,
            3076.19, 3108.26, 3113.13, 3122.64, 3137.03, 3158.63, 3216.14, 3229.78],
    fscale = 0.95,
    introt = [(0.939439, 3, 0, 0)],  # free rotor
    states = [(2, 0), (2, 0.09), (2, 165.67)], # conformers
    freqimg = 494.809
    )

# relative energies [cm^-1]
E0_nc5h11 = 948.38
E0_sc5h11 = 0.00
E0_ts_ncc = 11391.70
H0_ncc =  8625.83
E0_ts_scc = 10392.83
H0_scc = 7591.92

T = [300., 1000., 2000.]
redmass = name2weight("C2H4") * name2weight("C3H7") / name2weight("C5H11")
gelec_ratio = 1. * 2. / 2.
k = tstrates(T, nc5h11, [ts_ncc], [E0_ts_ncc-E0_nc5h11], [H0_ncc-E0_nc5h11])[0]
keq = equilibrium_consts_12(T, nc5h11, c2h4, nc3h7, redmass, gelec_ratio, H0_ncc-E0_nc5h11)
krev = k / keq

print("nC5H11 <=> C2H4 + nC3H7")
print("T[K]    k[s^-1]      krev[molecule cm^-3 s^-1]")
for i in range(len(T)):
    print("%5.0f  %12.6e  %12.6e" % (T[i], k[i], krev[i]))


redmass = name2weight("C2H5") * name2weight("C3H6") / name2weight("C5H11")
gelec_ratio = 1. * 2. / 2.
k = tstrates(T, sc5h11, [ts_scc], [E0_ts_scc-E0_sc5h11], [H0_scc-E0_sc5h11])[0]
keq = equilibrium_consts_12(T, sc5h11, c2h5, c3h6, redmass, gelec_ratio, H0_scc-E0_sc5h11)
krev = k / keq

print("")
print("sC5H11 <=> C3H6 + C2H5")
print("T[K]   k[s^-1]   krev[molecule cm^-3 s^-1]")
for i in range(len(T)):
    print("%5.0f  %12.6e  %12.6e" % (T[i], k[i], krev[i]))

